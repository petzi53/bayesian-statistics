{
  "hash": "1f7c42b22e9ad4cbb08feabd1bdc405b",
  "result": {
    "markdown": "# Probability {#sec-probability}\n\n## File setup {.unnumbered}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> ‚îÄ‚îÄ Attaching core tidyverse packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 2.0.0 ‚îÄ‚îÄ\n#> ‚úî dplyr     1.1.3     ‚úî readr     2.1.4\n#> ‚úî forcats   1.0.0     ‚úî stringr   1.5.0\n#> ‚úî ggplot2   3.4.3     ‚úî tibble    3.2.1\n#> ‚úî lubridate 1.9.2     ‚úî tidyr     1.3.0\n#> ‚úî purrr     1.0.2     \n#> ‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ\n#> ‚úñ dplyr::filter() masks stats::filter()\n#> ‚úñ dplyr::lag()    masks stats::lag()\n#> ‚Ñπ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(gt)\n```\n:::\n\n\n\n## Mission Statement\n\nIn Bayesian statistics, we formulate models in terms of entities called\nprobability distributions. This chapter provides an introduction to all\nthings related to probability.\n\n## Chapter Goals\n\nThe chapter focuses on probability distribution: - We define what is\nmeant by probability distribution. - We discuss why the distinction\nbetween likelihoods and probabilities is important. - We explain how to\nmanipulate probability distributions in order to derive quantities of\ninterest. - We show how to derive the Bayesian formula from the law of\nconditional probability.\n\n## Probability Distributions: Helping us to Explicitly State our Ignorance\n\n::: {#lem-random-variables}\n##### Random variables and probability distributions\n\n\n{{< video https://youtu.be/pvkhK03aFDM?si=sbI9_WI0ICjgEQuq >}}\n\n\n:::\n\nThe mathematical theory of probability provides a logic and language\nwhich is the only completely consistent framework to describe situations\ninvolving uncertainty. In probability theory, we describe the behaviour\nof random variables. This is a statistical term for variables that\nassociate different numeric values with each of the possible outcomes of\nsome random process. By random here we do not mean the colloquial use of\nthis term to mean something that is entirely unpredictable. A random\nprocess is simply a process whose outcome cannot be perfectly known\nahead of time (it may nonetheless be quite predictable).\n\n### What makes a probability distribution valid?\n\n::: {#lem-prob-dist}\n##### What is a probability distribution?\n\n\n{{< video https://youtu.be/4Ghtj_iTSpI?si=5J13qlUPoE9QZIgZ >}}\n\n\n:::\n\n1.  All values of the distribution must be real and non-negative.\n2.  The sum (for discrete random variables) or integral (for continuous\n    random variables) across all possible values of the random variable\n    must be 1.\n\nThis definition is of central importance to Bayesian statistics. Only\nvalid probability distributions can be used to describe uncertainty. The\npursuit of this ideal underlies the majority of all methods in applied\nBayesian statistics -- analytic and computational -- and hence its\nimportance cannot be overstated!\n\n::: {#lem-discrete-prob-dist}\n##### An introduction to discrete probability distributions\n\n\n{{< video https://youtu.be/4Ghtj_iTSpI?si=DYV0uTsKrz3w9jVZ >}}\n\n\n:::\n\n::: {#lem-continous-prob-dist}\n##### An introduction to continuous probability distributions\n\n\n{{< video https://youtu.be/s87mffcX0xU?si=_As5GZMSPCZEft76 >}}\n\n\n:::\n\n### Probabilities versus probability densities: interpreting discrete and continuous probability distributions\n\nWe can't assign probabilities to every possible value of continuous\ndistributions as we can do with discrete distributions. The reason is\nthat there would be infinite values (e.g., \\$2500, \\$2500.10, \\$2500.01,\n\\$2500.001). If we would sum up all these values we would not get 1 but\ninfinity.\n\nIf we reconsider the test values {\\$2500, \\$2500.10, \\$2500.01,\n\\$2500.001}, we reason that these are all equally unlikely and belong to\na set of an infinite number of potential values that we could draw. This\nmeans that, for a continuous random variable, we always have\n`Pr(Œ∏ = number) = 0`, to avoid an infinite sum. Hence, when we consider\n`p(Œ∏)` for a continuous random variable, it turns out we should\ninterpret its values as\n<a class='glossary' title=''>probability densities</a>, not\n<a class='glossary' title=''>probabilities</a>.\n\nThere are events that are impossible. These events have zero\nprobability. However, the converse is not true: some events that are of\nzero probability are still possible.\n\nWhile it is important to understand that <a class='glossary' title=''>probabilities</a>\nand <a class='glossary' title=''>probability densities</a> are not\nthe same types of entity, the good news for us is that\n<a class='glossary' title='This is the theorem that gives Bayesian data analysis its name. But the theorem itself is a trivial implication of probability theory. The mathematical definition of the posterior distribution arises from Bayes‚Äô Theorem. The key lesson is that the posterior is proportional to the product of the prior and the probability of the data. (Chap.2)'>Bayes‚Äô rule</a> is the same for each.\n\n\n::: {#thm-bayes-rule-dist-cont}\n\n##### Bayes‚Äô rule for discrete and continuous distributions\n$$\n\\begin{align*}\nPr(ùõ©=1\\|X=1) = \\frac{Pr(X=1|ùõ©=0)Pr(ùõ©=1)}{Pr(X=1)} \\\\\np(ùõ©=1\\|X=1) = \\frac{p(X=1|ùõ©=0)p(ùõ©=1)}{p(X=1)}\n\\end{align*}\n$$ {#eq-bayes-rule-dist-cont}\n\n:::\n\n### The mean of distributions\n\nA popular way of summarising a distribution is by its *mean*, which is a measure of central tendency for a distribution. More intuitively, a mean, or *expected value*, of a distribution is the long-run average value that would be obtained if we sampled from it an infinite number of times.\n\n\n\n::: {.callout-caution}\n##### TODO: Playing a computational lottery\n\n**Reproduce Figure 3.4:** As the number of games played increases, the sample mean approaches the true mean of $50\\frac{1}{2}$.  This quantity corresponds to the mean winning number that would be drawn from a lottery where the possible numbers are the integers from 1 to 100, each of which is equally likely.\n\n:::\n\n### Generalising probability distributions to two dimensions (2D)\n\nLife is often more complex than the (1D) examples encountered thus far. We often must reason about the outcomes of a number of processes, whose results may be interdependent. We begin by considering the outcome of two measurements to introduce the mechanics of two-dimensional probability distributions. Fortunately, these rules do not become more complex when generalising to higher dimensional problems.\n\n#### Matt‚Äôs horses: a 2D discrete probability example\n\nImagine that you are a horse racing aficionado and want to quantify the uncertainty in the outcome of two separate races. In each race there are two horses from a particular stable, called A and B. From their historical performance over 100 races, you notice that both horses often react the same way to the racing conditions. When horse A wins, it is more likely that, later in the day, B will also win, and vice versa, with similar interrelations for the losses; when A finds conditions tough, so does B.\n\n\n::: {#tbl-horse-race .cell tbl-cap='A probability distribution indicating the historical performance of two horses, A and B, that race in separate events'}\n\n```{.r .cell-code #lst-tbl-horse-race lst-cap=\"Reproduce Table 3.1\"}\nd <- new_tibble(list(rowname = c(\"Lose (0)\", \"Win (1)\"),\n    `Lose (0)` = c(0.3, 0.1), \n    `Win (1)` = c(0.1, 0.5))) \n\nd |> \n    gt() |> \n    tab_stubhead(label = \"Horse B\") |> \n    tab_spanner(\n        label = \"Horse A\",\n        columns = c(\"Lose (0)\", \"Win (1)\")\n    ) |> \n    cols_label(\n        \"Lose (0)\" = html(\"Lose<br>(0)\"),\n        \"Win (1)\" = html(\"Win<br>(1)\")\n    )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"rwbdhfgxbd\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#rwbdhfgxbd table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#rwbdhfgxbd thead, #rwbdhfgxbd tbody, #rwbdhfgxbd tfoot, #rwbdhfgxbd tr, #rwbdhfgxbd td, #rwbdhfgxbd th {\n  border-style: none;\n}\n\n#rwbdhfgxbd p {\n  margin: 0;\n  padding: 0;\n}\n\n#rwbdhfgxbd .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#rwbdhfgxbd .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#rwbdhfgxbd .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#rwbdhfgxbd .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#rwbdhfgxbd .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rwbdhfgxbd .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rwbdhfgxbd .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rwbdhfgxbd .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#rwbdhfgxbd .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#rwbdhfgxbd .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#rwbdhfgxbd .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#rwbdhfgxbd .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#rwbdhfgxbd .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#rwbdhfgxbd .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#rwbdhfgxbd .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#rwbdhfgxbd .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#rwbdhfgxbd .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#rwbdhfgxbd .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#rwbdhfgxbd .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rwbdhfgxbd .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#rwbdhfgxbd .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#rwbdhfgxbd .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#rwbdhfgxbd .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rwbdhfgxbd .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#rwbdhfgxbd .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#rwbdhfgxbd .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rwbdhfgxbd .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rwbdhfgxbd .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#rwbdhfgxbd .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rwbdhfgxbd .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#rwbdhfgxbd .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rwbdhfgxbd .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rwbdhfgxbd .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rwbdhfgxbd .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rwbdhfgxbd .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rwbdhfgxbd .gt_left {\n  text-align: left;\n}\n\n#rwbdhfgxbd .gt_center {\n  text-align: center;\n}\n\n#rwbdhfgxbd .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#rwbdhfgxbd .gt_font_normal {\n  font-weight: normal;\n}\n\n#rwbdhfgxbd .gt_font_bold {\n  font-weight: bold;\n}\n\n#rwbdhfgxbd .gt_font_italic {\n  font-style: italic;\n}\n\n#rwbdhfgxbd .gt_super {\n  font-size: 65%;\n}\n\n#rwbdhfgxbd .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#rwbdhfgxbd .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#rwbdhfgxbd .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#rwbdhfgxbd .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#rwbdhfgxbd .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#rwbdhfgxbd .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#rwbdhfgxbd .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"Horse B\">Horse B</th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Horse A\">\n        <span class=\"gt_column_spanner\">Horse A</span>\n      </th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Lose&lt;br&gt;(0)\">Lose<br>(0)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Win&lt;br&gt;(1)\">Win<br>(1)</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><th id=\"stub_1_1\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Lose (0)</th>\n<td headers=\"stub_1_1 Lose (0)\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"stub_1_1 Win (1)\" class=\"gt_row gt_right\">0.1</td></tr>\n    <tr><th id=\"stub_1_2\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Win (1)</th>\n<td headers=\"stub_1_2 Lose (0)\" class=\"gt_row gt_right\">0.1</td>\n<td headers=\"stub_1_2 Win (1)\" class=\"gt_row gt_right\">0.5</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\nThis distribution satisfy the requirements for a valid probability distribution because:\n\n1. All the values of the distribution are real and non-negative\n2. The sum of all cells of the two discrete random variables results in 1, e.g. the distribution is normalized.\n\nThe table displays the outcome of two random variables. Since the probability distribution is a function of two variables, we say that it is two-dimensional (2D).\n\nInterpret the table we can say that it is very unlikely that one horse win and the other lose (10% each). The highest probability is that both horses win (50%). An intermediate probability of 30% is assigned to the case that both horses lose.\n\n\n::: {#lem-2d-discrete-dist}\n##### 2D discrete distributions: an introduction\n\n{{< video https://youtu.be/trWTk31jYQU?si=JmwlKuJAidVYEL8m >}}\n\n\n:::\n\n#### Foot length and literacy: a 2D continuous probability example\n\nSuppose that we measure the foot size and literacy test scores for a group of individuals. Both of these variables can be assumed to be continuous, meaning that we represent our strength of beliefs by specifying a two-dimensional probability distribution across a continuum of values. Since this distribution is two-dimensional we need three dimensions to plot it ‚Äì two dimensions for the variables and one dimension for the probability density. These three-dimensional plots are, however, a bit cumbersome to deal with, and so we prefer to use contour plots to graph two-dimensional continuous probability distributions. In <a class='glossary' title=''>contour plots</a>, we mark the set of positions where the value of the probability density function is constant, as contour lines. The rate of change of the gradient of the function at a particular position in parameter space is, hence, determined by the local density of contour lines.\n\nPlug-in unit: @sec-annex-example-1\n\n::: {#lem-2d-cont-dist}\n##### 2D continuous distributions: an introduction\n\n\n{{< video https://youtu.be/0BxDoyiZd44?si=Q1KlEFDmvp2xUJZy >}}\n\n\n:::\n\n### Marginal distributions\n\nAlthough in the horse racing example there are two separate races, each with an uncertain outcome, we can still consider the outcome of one race on its own. Suppose, for example, that we witness only the result for A. What would be the probability distribution that describes this outcome?\n\nTo calculate this, we must average out the dependence of the other variable. Since we are interested only in the result of A, we can sum down the column values for B to give us the marginal distribution of A. Hence, we see that the marginal probability of A winning is 0.6. \n\n\n::: {#tbl-horse-race-2 .cell tbl-cap='The marginal distributions of A and B (shown below and to the right of the joint density values, respectively), achieved by summing the values in each column or row, respectively.'}\n\n```{.r .cell-code #lst-tbl-horse-race-2 lst-cap=\"Reproduce Table 3.2\"}\nd2 <- tibble(janitor::adorn_totals(d, c(\"row\", \"col\")))\nd2$rowname[[3]] <-  \"Pr(A_X )\"\n\nd2 |> \n    gt() |> \n    tab_stubhead(label = \"Horse B\") |> \n    tab_spanner(\n        label = \"Horse A\",\n        columns = c(\"Lose (0)\", \"Win (1)\")\n    ) |> \n    cols_label(\n        \"Lose (0)\" = html(\"Lose<br>(0)\"),\n        \"Win (1)\" = html(\"Win<br>(1)\"),\n        Total ~ \"{{Pr(X_B )}}\"\n    ) |> \n    fmt_units(columns = rowname)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"dcsdzieuol\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#dcsdzieuol table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#dcsdzieuol thead, #dcsdzieuol tbody, #dcsdzieuol tfoot, #dcsdzieuol tr, #dcsdzieuol td, #dcsdzieuol th {\n  border-style: none;\n}\n\n#dcsdzieuol p {\n  margin: 0;\n  padding: 0;\n}\n\n#dcsdzieuol .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#dcsdzieuol .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#dcsdzieuol .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#dcsdzieuol .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#dcsdzieuol .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#dcsdzieuol .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dcsdzieuol .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#dcsdzieuol .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#dcsdzieuol .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#dcsdzieuol .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#dcsdzieuol .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#dcsdzieuol .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#dcsdzieuol .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#dcsdzieuol .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#dcsdzieuol .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#dcsdzieuol .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#dcsdzieuol .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#dcsdzieuol .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#dcsdzieuol .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dcsdzieuol .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#dcsdzieuol .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#dcsdzieuol .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#dcsdzieuol .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dcsdzieuol .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#dcsdzieuol .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#dcsdzieuol .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dcsdzieuol .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dcsdzieuol .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#dcsdzieuol .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dcsdzieuol .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#dcsdzieuol .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dcsdzieuol .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#dcsdzieuol .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dcsdzieuol .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#dcsdzieuol .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dcsdzieuol .gt_left {\n  text-align: left;\n}\n\n#dcsdzieuol .gt_center {\n  text-align: center;\n}\n\n#dcsdzieuol .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#dcsdzieuol .gt_font_normal {\n  font-weight: normal;\n}\n\n#dcsdzieuol .gt_font_bold {\n  font-weight: bold;\n}\n\n#dcsdzieuol .gt_font_italic {\n  font-style: italic;\n}\n\n#dcsdzieuol .gt_super {\n  font-size: 65%;\n}\n\n#dcsdzieuol .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#dcsdzieuol .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#dcsdzieuol .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#dcsdzieuol .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#dcsdzieuol .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#dcsdzieuol .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#dcsdzieuol .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings gt_spanner_row\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"Horse B\">Horse B</th>\n      <th class=\"gt_center gt_columns_top_border gt_column_spanner_outer\" rowspan=\"1\" colspan=\"2\" scope=\"colgroup\" id=\"Horse A\">\n        <span class=\"gt_column_spanner\">Horse A</span>\n      </th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"2\" colspan=\"1\" scope=\"col\" id=\"Pr(X&lt;span style=&quot;white-space:nowrap;&quot;&gt;&lt;sub&gt;B&lt;/sub&gt;&lt;/span&gt;)\">Pr(X<span style=\"white-space:nowrap;\"><sub>B</sub></span>)</th>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Lose&lt;br&gt;(0)\">Lose<br>(0)</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Win&lt;br&gt;(1)\">Win<br>(1)</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><th id=\"stub_1_1\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Lose (0)</th>\n<td headers=\"stub_1_1 Lose (0)\" class=\"gt_row gt_right\">0.3</td>\n<td headers=\"stub_1_1 Win (1)\" class=\"gt_row gt_right\">0.1</td>\n<td headers=\"stub_1_1 Total\" class=\"gt_row gt_right\">0.4</td></tr>\n    <tr><th id=\"stub_1_2\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Win (1)</th>\n<td headers=\"stub_1_2 Lose (0)\" class=\"gt_row gt_right\">0.1</td>\n<td headers=\"stub_1_2 Win (1)\" class=\"gt_row gt_right\">0.5</td>\n<td headers=\"stub_1_2 Total\" class=\"gt_row gt_right\">0.6</td></tr>\n    <tr><th id=\"stub_1_3\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Pr(A<span style=\"white-space:nowrap;\"><sub>X</sub></span>)</th>\n<td headers=\"stub_1_3 Lose (0)\" class=\"gt_row gt_right\">0.4</td>\n<td headers=\"stub_1_3 Win (1)\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"stub_1_3 Total\" class=\"gt_row gt_right\">1.0</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\nSo to calculate the probability of a single event we just sum the probabilities of all the potential ways this can happen. This amounts to summing over all potential states of the other variable. \n\n::: {#lem-disc-marg-dist}\n##### Discrete marginal probability distributions\n\n\n{{< video https://youtu.be/M3MlaoW0TT4?si=CvxVNwYQBQzXYnuR >}}\n\n\n\n:::\n\n::: {.callout-tip}\nMarginal distributions gets their name because for discrete random variables, they are obtained by summing a row or column of a table and placing the result in its margins.\n:::\n\nIn the foot size and literacy test example, suppose we want to summarise the distribution for literacy score, irrespective of foot size. We can obtain this distribution by ‚Äòintegrating out‚Äô the dependence on foot size.\n\nAnother way to think about marginal densities is to imagine walking across the landscape of the joint density, where regions of greater density represent hills. To calculate the marginal density for a literacy score of 100 we walk along the horizontal line that corresponds to this score and record the number of calories we burn in walking. If the path is relatively flat, we burn fewer calories and the corresponding marginal density is low. However, if the path includes a large hill, we burn a lot of energy and the marginal density is high.\n\n\n\n::: {#lem-cont-marg-dist}\n\n##### Continuous marginal probability distributions\n\n{{< video https://youtu.be/F97Qf5FGt5M?si=Eam2mN6IKxgLla4k >}}\n\n\n\n:::\n\n#### Marginal distribution by sampling\n\nAn alternative approach to estimating the marginal distribution of literacy test score is by sampling from the joint distribution of literacy score and foot size. To estimate these marginal distributions we ignore the observations of the variable not directly of interest and draw a histogram of the remaining samples. While not exact, the shape of this histogram is a good approximation of the marginal distribution if we have enough samples.\n\n#### Venn diagrams\n\nAn alternative way to think about marginal distributions is using Venn diagrams.\n\n### Conditional distributions\n\nWe sometimes receive only partial information about a system which is of interest to us. In probability, when we observe one variable and want to update our uncertainty for another variable, we are seeking a conditional distribution. This is because we compute the probability distribution of one uncertain variable, conditional on the known value of the other(s).\n\nIn each case, we have reduced some of the uncertainty in the system by observing one of its characteristics. Hence, in the two-dimensional examples described above, the conditional distribution is one-dimensional because we are only now uncertain about one variable.\n\n::: {#thm-cond-dist}\n##### Probability of one variable, conditional on the value of the other\n\n$$\np(A|B) = \\frac{p(A,B)}{p(B)}\n$$\n:::\n\n",
    "supporting": [
      "03-probability_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}